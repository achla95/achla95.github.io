<!DOCTYPE html>
<html lang=fr" dir="ltr">
   <head>
      <meta charset="utf-8">
      <link rel="stylesheet" href="styles.css">
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
      <link rel="stylesheet" href="../../../styles/default.css">
      <script src="../../../highlight.pack.js"></script>
      <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
      <script src="https://kit.fontawesome.com/a076d05399.js"></script>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>RSA Factorisation</title>
   </head>
   <body>
      <nav>
         <div class="logo">
            Achla95's blog
         </div>
         <label for="btn" class="icon">
         <span class="fa fa-bars"></span>
         </label>
         <input type="checkbox" id="btn">
         <ul>
            <li><a href="../../../index.html">Home</a></li>
            <li>
               <label for="btn-1" class="show">Whoami +</label>
               <a href="#">Whoami</a>
               <input type="checkbox" id="btn-1">
               <ul>
                  <li><a href="#">Discord(soon)</a></li>
                  <li><a href="https://twitter.com/achla95" target="_blank">Twitter</a></li>
               </ul>
            </li>
            <li>
               <label for="btn-2" class="show">Catégories +</label>
               <a href="#">Catégories</a>
               <input type="checkbox" id="btn-2">
               <ul>
                  <li><a href="#">Web</a></li>
                  <li><a href="#">Crypto</a></li>
               </ul>
            </li>
         </ul>
      </nav>
      <div class="container">
            <h1>Root-Me : RSA Factorisation</h1>
            <p>On se retrouve pour un write-up venant de <span>Root-Me</span> cette fois çi.</p>
            <p>Le but était de retrouver le flag, on disposait des informations suivantes : </p>
            <div class="info">
    <pre><code class="py">cyphertext = "e8oQDihsmkvjT3sZe+EE8lwNvBEsFegYF6+OOFOiR6gMtMZxxba/bIgLUD8pV3yEf0gOOfHuB5bC3vQmo7bE4PcIKfpFGZBA"
publickey.pem = "-----BEGIN PUBLIC KEY-----
                MGQwDQYJKoZIhvcNAQEBBQADUwAwUAJJAMLLsk/b+SO2Emjj8Ro4lt5FdLO6WHMM
                vWUpOIZOIiPu63BKF8/QjRa0aJGmFHR1mTnG5Jqv5/JZVUjHTB1/uNJM0VyyO0zQ
                owIDAQAB
                -----END PUBLIC KEY-----"</pre></code>
            </div>
            <br>
            <br>
            <p>En partant du principe que vous connaissez les bases concernant le chiffrement rsa, il me fallait : N,e,phi(n) et d</p>
            <p>afin de retoruver le message en clair</p>
            openssl rsa -pubin -in pubkey.pem -text -noout -modulus   
            <p>d'obtenir le flag. J'ai donc fait un petit script python et le tour est joué. </p>
            <br>
            <br>
      </div>
      <div class="code">
      <pre><code class="py">
        from binascii import hexlify,unhexlify
        import base64
        import rsa
        
        msg = base64.b64decode("e8oQDihsmkvjT3sZe+EE8lwNvBEsFegYF6+OOFOiR6gMtMZxxba/bIgLUD8pV3yEf0gOOfHuB5bC3vQmo7bE4PcIKfpFGZBA")
        msg_decoded = int(hexlify(msg),16)
        
        
        
        e = 65537
        
        n = 188198812920607963838697239461650439807163563379417382700763356422988859715234665485319060606504743045317388011303396716199692321205734031879550656996221305168759307650257059
        p = 398075086424064937397125500550386491199064362342526708406385189575946388957261768583317
        q = 472772146107435302536223071973048224632914695302097116459852171130520711256363590397527
        phi_n = (p-1)*(q-1)
        
        d = pow(e,-1,phi_n)
        solve = rsa.PrivateKey(n,e,d,p,q)
        
        plaintext = rsa.decrypt(msg,solve)
        print(plaintext)</code></pre>
            </div>
            <br>
            <br>
            <p>And Voilà, c'était un petit challenge sympathique, j'étais déjà informé sur le xor mais pas à propos de ses propriétés </p>
            <p>ce qui était très intéressant.</p>
            <br>
            <br>
    </body>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
</html>